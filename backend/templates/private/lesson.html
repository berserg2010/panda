{% extends 'private/_base.html' %}

{% load static private_side_extras %}

{% block title %}Занятие{% endblock %}

{% block style %}
{% endblock %}

{% block content %}

  <div class="personalArea-content">
    <div class="personalArea-block">
      <div class="personalArea-block__top">
        <span class="personalArea-block__title">Занятие</span>
        <div class="personalArea-block__top-b"></div>
      </div>

      <div class="videoCall">
        <div class="videoCall-row">

          <div class="videoCall-col videoCall-col__1">
            <div class="videoCall-main">
              <div id="remoteVideoContainer" class="videoCall-user">
                <img src="{% static 'img/videoCall-user.svg' %}" height="300px" alt="">
              </div>

              <div id="localVideoContainer" class="videoCall-you">
                <img src="{% static 'img/videoCall-hi.svg' %}" height="100px" alt="">
              </div>

              <div class="videoCall-buttons">
                <ul class="videoCall-buttons__list">
                  <li>
                    <button id="switchMicStateButton" type="button" disabled>
                      <svg width="14" height="19" viewBox="0 0 14 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M7 0C7.79565 0 8.55871 0.316071 9.12132 0.87868C9.68393 1.44129 10 2.20435 10 3V9C10 9.79565 9.68393 10.5587 9.12132 11.1213C8.55871 11.6839 7.79565 12 7 12C6.20435 12 5.44129 11.6839 4.87868 11.1213C4.31607 10.5587 4 9.79565 4 9V3C4 2.20435 4.31607 1.44129 4.87868 0.87868C5.44129 0.316071 6.20435 0 7 0V0ZM14 9C14 12.53 11.39 15.44 8 15.93V19H6V15.93C2.61 15.44 0 12.53 0 9H2C2 10.3261 2.52678 11.5979 3.46447 12.5355C4.40215 13.4732 5.67392 14 7 14C8.32608 14 9.59785 13.4732 10.5355 12.5355C11.4732 11.5979 12 10.3261 12 9H14Z" fill="#5F9F84"></path>
                      </svg>
                    </button>
                  </li>
                  <li>
                    <button id="showLocalVideoButton" type="button" disabled>
                      <svg width="18" height="12" viewBox="0 0 18 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M14 4.5V1C14 0.734784 13.8946 0.48043 13.7071 0.292893C13.5196 0.105357 13.2652 0 13 0H1C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V11C0 11.2652 0.105357 11.5196 0.292893 11.7071C0.48043 11.8946 0.734784 12 1 12H13C13.2652 12 13.5196 11.8946 13.7071 11.7071C13.8946 11.5196 14 11.2652 14 11V7.5L18 11.5V0.5L14 4.5Z" fill="#5F9F84"></path>
                      </svg>
                    </button>
                  </li>
                  <li>
                    <button id="shareScreenButton" type="button" disabled>
                      <svg width="24" height="16" viewBox="0 0 24 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M20 14C21.1 14 21.99 13.1 21.99 12L22 2.00001C22 0.890014 21.1 0 20 0H3.99998C2.88998 0 1.99997 0.890014 1.99997 2.00001V12C2.00002 13.1 2.88998 14 3.99998 14H0V16H24V14H20ZM13 10.47V8.27998C10.22 8.27998 8.38997 9.12997 6.99998 11C7.56 8.33 9.10997 5.66999 13 5.12999V2.99999L17 6.72997L13 10.47Z" fill="#5F9F84"></path>
                      </svg>
                    </button>
                  </li>
                   <li>
                    <button id="fullScreenButton" type="button" disabled>
                      <svg width="24" height="16" viewBox="0 0 24 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M20 14C21.1 14 21.99 13.1 21.99 12L22 2.00001C22 0.890014 21.1 0 20 0H3.99998C2.88998 0 1.99997 0.890014 1.99997 2.00001V12C2.00002 13.1 2.88998 14 3.99998 14H0V16H24V14H20ZM13 10.47V8.27998C10.22 8.27998 8.38997 9.12997 6.99998 11C7.56 8.33 9.10997 5.66999 13 5.12999V2.99999L17 6.72997L13 10.47Z" fill="red"></path>
                      </svg>
                    </button>
                  </li>
                </ul>
                <button id="callButton" type="button" class="videoCall-buttons__btn">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="m 15.630681,14.39932 -2.52,2.5 c -2.5,-1.43 -4.5700002,-3.5 -6.0000002,-6.000001 l 2.5,-2.5199987 c 0.2299998,-0.24 0.3299998,-0.57 0.2699998,-0.9 l -0.7499998,-3.68 c -0.09,-0.46 -0.5,-0.8 -0.98,-0.8 h -4.15 c -0.5600001,0 -1.0300001,0.47 -1.0000001,1.03 0.17,2.89 1.0500001,5.6 2.4300001,7.9699987 1.58,2.730001 3.85,4.990001 6.5700002,6.570001 2.37,1.37 5.08,2.26 7.97,2.43 0.56,0.03 1.03,-0.44 1.03,-1 v -4.15 c 0,-0.48 -0.34,-0.89 -0.8,-0.98 l -3.67,-0.73 c -0.33,-0.07 -0.67,0.03 -0.9,0.26 z" fill="#F8FFFC"></path>
                  </svg>
                </button>

                <button id="cancelButton" type="button" class="videoCall-buttons__btn" hidden>
                  <svg width="30" height="12" viewBox="0 0 30 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15 2.5C13 2.5 11.0625 2.8125 9.25 3.4V7.275C9.25 7.775 8.9625 8.2 8.55 8.4C7.325 9.0125 6.2125 9.8 5.2125 10.7125C5 10.9375 4.6875 11.075 4.375 11.075C4 11.075 3.6875 10.925 3.4625 10.7L0.3625 7.6C0.1375 7.375 0 7.0625 0 6.725C0 6.375 0.1375 6.0625 0.3625 5.8375C4.175 2.2125 9.325 0 15 0C20.675 0 25.825 2.2125 29.6375 5.8375C29.8625 6.0625 30 6.375 30 6.725C30 7.0625 29.8625 7.375 29.6375 7.6L26.5375 10.7C26.3125 10.925 26 11.075 25.625 11.075C25.3125 11.075 25 10.9375 24.775 10.7125C23.7875 9.8 22.675 9.0125 21.45 8.4C21.0375 8.2 20.75 7.775 20.75 7.275V3.4C18.9375 2.8125 17 2.5 15 2.5Z" fill="#F8FFFC"></path>
                  </svg>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

{% endblock %}

{% block script %}

  <script type="text/javascript" src="https://cdn.voximplant.com/edge/voximplant.min.js"></script>
  <script type="text/javascript" src="{% static 'js/app.js' %}"></script>

  {{ user.is_staff|json_script:'is_staff' }}
  {{ object.paid_course.teacher.pk|json_script:'teacher' }}
  {{ object.paid_course.student.pk|json_script:'student' }}
  {{ object.pk|json_script:'lesson' }}

  <script>

    const is_staff = JSON.parse(document.getElementById('is_staff').textContent)
    const teacher = JSON.parse(document.getElementById('teacher').textContent)
    const student = JSON.parse(document.getElementById('student').textContent)
    const lesson = JSON.parse(document.getElementById('lesson').textContent)

    const getUser = (self = true) => {
      const condition = self ? is_staff : !is_staff
      return condition ? 'teacher' : 'student'
    }

    const username = getUser()

  </script>

{% endblock %}
