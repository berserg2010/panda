{% extends 'private/_base.html' %}

{% load static private_side_extras %}

{% block title %}Занятие{% endblock %}

{% block style %}
  {#  <style>#}
  {#    html, body {#}
  {#      height: 100%;#}
  {#    }#}
  {##}
  {#    div.container {#}
  {#      width: 740px;#}
  {#    }#}
  {##}
  {#    div.panel-body {#}
  {#      display: flex;#}
  {#      flex-direction: column;#}
  {#    }#}
  {##}
  {#    #voximplant_container {#}
  {#      width: 650px;#}
  {#      margin: 20px auto;#}
  {#      display: flex;#}
  {#      flex-wrap: wrap;#}
  {#    }#}
  {##}
  {#    #log {#}
  {#      margin: 20px;#}
  {#      text-align: left;#}
  {#      font-size: 70%;#}
  {#      font-family: Monospace;#}
  {#    }#}
  {##}
  {#    #controls {#}
  {#      width: 650px;#}
  {#      margin: 0 auto;#}
  {#      display: flex;#}
  {#      flex-direction: column;#}
  {#    }#}
  {##}
  {#    #controls div.input-group {#}
  {#      float: none;#}
  {#      width: 320px;#}
  {#      margin: 0 auto;#}
  {#      margin-bottom: 5px;#}
  {#    }#}
  {##}
  {#    #controls button {#}
  {#      float: none;#}
  {#    }#}
  {##}
  {#    #voximplantlocalvideo {#}
  {#      float: left;#}
  {#      width: 320px;#}
  {#      height: 240px;#}
  {#    }#}
  {##}
  {#    .vertical-center {#}
  {#      height:100%;#}
  {#      width:100%;#}
  {##}
  {#      text-align: center;  /* align the inline(-block) elements horizontally */#}
  {#      font: 0/0 a;         /* remove the gap between inline(-block) elements */#}
  {#    }#}
  {##}
  {#    .vertical-center:before {    /* create a full-height inline block pseudo=element */#}
  {#      content: ' ';#}
  {#      display: inline-block;#}
  {#      vertical-align: middle;  /* vertical alignment of the inline element */#}
  {#      height: 100%;#}
  {#    }#}
  {##}
  {#    .vertical-center > .container {#}
  {#      max-width: 100%;#}
  {#      display: inline-block;#}
  {#      vertical-align: middle;  /* vertical alignment of the inline element */#}
  {#      font: 16px/1 "Helvetica Neue", Helvetica, Arial, sans-serif;        /* <-- reset the font property */#}
  {#    }#}
  {#    .bootstrap-dialog {#}
  {##}
  {#    }#}
  {#    .bootstrap-dialog .modal-header {#}
  {#      border-top-left-radius: 4px;#}
  {#      border-top-right-radius: 4px;#}
  {#    }#}
  {#    .bootstrap-dialog .bootstrap-dialog-title {#}
  {#      color: #fff;#}
  {#      display: inline-block;#}
  {#    }#}
  {#    .bootstrap-dialog.type-default .bootstrap-dialog-title {#}
  {#      color: #333;#}
  {#    }#}
  {#    .bootstrap-dialog.size-normal .bootstrap-dialog-title {#}
  {#      font-size: 16px;#}
  {#    }#}
  {#    .bootstrap-dialog.size-large .bootstrap-dialog-title {#}
  {#      font-size: 24px;#}
  {#    }#}
  {#    .bootstrap-dialog .bootstrap-dialog-close-button {#}
  {#      float: right;#}
  {#      filter:alpha(opacity=90);#}
  {#      -moz-opacity:0.9;#}
  {#      -khtml-opacity: 0.9;#}
  {#      opacity: 0.9;#}
  {#    }#}
  {#    .bootstrap-dialog.size-normal .bootstrap-dialog-close-button {#}
  {#      font-size: 20px;#}
  {#    }#}
  {#    .bootstrap-dialog.size-large .bootstrap-dialog-close-button {#}
  {#      font-size: 30px;#}
  {#    }#}
  {#    .bootstrap-dialog .bootstrap-dialog-close-button:hover {#}
  {#      cursor: pointer;#}
  {#      filter: alpha(opacity=100);#}
  {#      -moz-opacity: 1;#}
  {#      -khtml-opacity: 1;#}
  {#      opacity: 1;#}
  {#    }#}
  {#    .bootstrap-dialog.size-normal .bootstrap-dialog-message {#}
  {#      font-size: 14px;#}
  {#    }#}
  {#    .bootstrap-dialog.size-large .bootstrap-dialog-message {#}
  {#      font-size: 18px;#}
  {#    }#}
  {#    .bootstrap-dialog.type-default .modal-header {#}
  {#      background-color: #fff;#}
  {#    }#}
  {#    .bootstrap-dialog.type-info .modal-header {#}
  {#      background-color: #5bc0de;#}
  {#    }#}
  {#    .bootstrap-dialog.type-primary .modal-header {#}
  {#      background-color: #428bca;#}
  {#    }#}
  {#    .bootstrap-dialog.type-success .modal-header {#}
  {#      background-color: #5cb85c;#}
  {#    }#}
  {#    .bootstrap-dialog.type-warning .modal-header {#}
  {#      background-color: #f0ad4e;#}
  {#    }#}
  {#    .bootstrap-dialog.type-danger .modal-header {#}
  {#      background-color: #d9534f;#}
  {#    }#}
  {#    .bootstrap-dialog .bootstrap-dialog-button-icon {#}
  {#      margin-right: 3px;#}
  {#    }#}
  {##}
  {#    /**#}
  {#     * Icon animation#}
  {#     * Copied from font-awesome: http://fontawesome.io/#}
  {#     **/#}
  {#    .icon-spin {#}
  {#      display: inline-block;#}
  {#      -moz-animation: spin 2s infinite linear;#}
  {#      -o-animation: spin 2s infinite linear;#}
  {#      -webkit-animation: spin 2s infinite linear;#}
  {#      animation: spin 2s infinite linear;#}
  {#    }#}
  {#    @-moz-keyframes spin {#}
  {#      0% {#}
  {#        -moz-transform: rotate(0deg);#}
  {#      }#}
  {#      100% {#}
  {#        -moz-transform: rotate(359deg);#}
  {#      }#}
  {#    }#}
  {#    @-webkit-keyframes spin {#}
  {#      0% {#}
  {#        -webkit-transform: rotate(0deg);#}
  {#      }#}
  {#      100% {#}
  {#        -webkit-transform: rotate(359deg);#}
  {#      }#}
  {#    }#}
  {#    @-o-keyframes spin {#}
  {#      0% {#}
  {#        -o-transform: rotate(0deg);#}
  {#      }#}
  {#      100% {#}
  {#        -o-transform: rotate(359deg);#}
  {#      }#}
  {#    }#}
  {#    @-ms-keyframes spin {#}
  {#      0% {#}
  {#        -ms-transform: rotate(0deg);#}
  {#      }#}
  {#      100% {#}
  {#        -ms-transform: rotate(359deg);#}
  {#      }#}
  {#    }#}
  {#    @keyframes spin {#}
  {#      0% {#}
  {#        transform: rotate(0deg);#}
  {#      }#}
  {#      100% {#}
  {#        transform: rotate(359deg);#}
  {#      }#}
  {#    }#}
  {#  </style>#}
{% endblock %}

{% block content %}

  <div class="personalArea-content">
  <div class="personalArea-block">
    <div class="personalArea-block__top">
      <span class="personalArea-block__title">Занятие</span>
      <div class="personalArea-block__top-b"></div>
    </div>

    <div class="videoCall">
      <div class="videoCall-row">

        <div class="videoCall-col videoCall-col__1"  style="overflow: hidden">
{#          <div class="input-wrapper">#}
{#            <div class="input-group">#}
{#              <span class="input-group-addon">@</span>#}
{#              <input id="phonenum" type="text" class="form-control" placeholder="Username">#}
{#            </div>#}
{#          </div>#}
          <div class="videoCall-main">
            <div id="voximplant_container"></div>

            <div class="videoCall-buttons">

              <ul class="videoCall-buttons__list">
                <li>
                  <a href="#">
                    <svg width="14" height="19" viewBox="0 0 14 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M7 0C7.79565 0 8.55871 0.316071 9.12132 0.87868C9.68393 1.44129 10 2.20435 10 3V9C10 9.79565 9.68393 10.5587 9.12132 11.1213C8.55871 11.6839 7.79565 12 7 12C6.20435 12 5.44129 11.6839 4.87868 11.1213C4.31607 10.5587 4 9.79565 4 9V3C4 2.20435 4.31607 1.44129 4.87868 0.87868C5.44129 0.316071 6.20435 0 7 0V0ZM14 9C14 12.53 11.39 15.44 8 15.93V19H6V15.93C2.61 15.44 0 12.53 0 9H2C2 10.3261 2.52678 11.5979 3.46447 12.5355C4.40215 13.4732 5.67392 14 7 14C8.32608 14 9.59785 13.4732 10.5355 12.5355C11.4732 11.5979 12 10.3261 12 9H14Z" fill="#5F9F84"></path>
                    </svg>
                  </a>
                </li>
                <li>
                  <a href="#">
                    <svg width="18" height="12" viewBox="0 0 18 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M14 4.5V1C14 0.734784 13.8946 0.48043 13.7071 0.292893C13.5196 0.105357 13.2652 0 13 0H1C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V11C0 11.2652 0.105357 11.5196 0.292893 11.7071C0.48043 11.8946 0.734784 12 1 12H13C13.2652 12 13.5196 11.8946 13.7071 11.7071C13.8946 11.5196 14 11.2652 14 11V7.5L18 11.5V0.5L14 4.5Z" fill="#5F9F84"></path>
                    </svg>
                  </a>
                </li>
                <li>
                  <a href="#">
                    <svg width="16" height="20" viewBox="0 0 16 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M10 0H2C1.46957 0 0.960859 0.210714 0.585786 0.585786C0.210714 0.960859 0 1.46957 0 2V18C0 18.5304 0.210714 19.0391 0.585786 19.4142C0.960859 19.7893 1.46957 20 2 20H14C14.5304 20 15.0391 19.7893 15.4142 19.4142C15.7893 19.0391 16 18.5304 16 18V6L10 0ZM9.5 14V17H6.5V14H4L8 10L12 14H9.5ZM9 7V1.5L14.5 7H9Z" fill="#5F9F84"></path>
                    </svg>
                  </a>
                </li>
                <li>
                  <button type="button" id="fsButton">
                    <svg width="24" height="16" viewBox="0 0 24 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M20 14C21.1 14 21.99 13.1 21.99 12L22 2.00001C22 0.890014 21.1 0 20 0H3.99998C2.88998 0 1.99997 0.890014 1.99997 2.00001V12C2.00002 13.1 2.88998 14 3.99998 14H0V16H24V14H20ZM13 10.47V8.27998C10.22 8.27998 8.38997 9.12997 6.99998 11C7.56 8.33 9.10997 5.66999 13 5.12999V2.99999L17 6.72997L13 10.47Z" fill="#5F9F84"></path>
                    </svg>
                  </button>
                </li>
              </ul>
              {#                  <button id="connect-to-peer-btn" class="videoCall-buttons__btn">#}
              <button type="button" id="callButton" class="videoCall-buttons__btn">
                <svg width="30" height="12" viewBox="0 0 30 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M15 2.5C13 2.5 11.0625 2.8125 9.25 3.4V7.275C9.25 7.775 8.9625 8.2 8.55 8.4C7.325 9.0125 6.2125 9.8 5.2125 10.7125C5 10.9375 4.6875 11.075 4.375 11.075C4 11.075 3.6875 10.925 3.4625 10.7L0.3625 7.6C0.1375 7.375 0 7.0625 0 6.725C0 6.375 0.1375 6.0625 0.3625 5.8375C4.175 2.2125 9.325 0 15 0C20.675 0 25.825 2.2125 29.6375 5.8375C29.8625 6.0625 30 6.375 30 6.725C30 7.0625 29.8625 7.375 29.6375 7.6L26.5375 10.7C26.3125 10.925 26 11.075 25.625 11.075C25.3125 11.075 25 10.9375 24.775 10.7125C23.7875 9.8 22.675 9.0125 21.45 8.4C21.0375 8.2 20.75 7.775 20.75 7.275V3.4C18.9375 2.8125 17 2.5 15 2.5Z" fill="#F8FFFC"></path>
                </svg>
              </button>
              {#                  </button>#}
            </div>

          </div>
        </div>

      </div>
    </div>

    <div id="log" class="well hidden">

    </div>
  </div>

{% endblock %}

{% block script %}

  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="{% static 'js/bootstrap-dialog.js' %}"></script>
  <script type="text/javascript" src="//cdn.voximplant.com/edge/voximplant.min.js"></script>
  <script type="text/javascript" src="{% static 'js/app.js' %}"></script>

  {{ user.is_staff|json_script:'is_staff' }}
  {{ object.paid_course.teacher.pk|json_script:'teacher' }}
  {{ object.paid_course.student.pk|json_script:'student' }}
  {{ object.pk|json_script:'lesson' }}

  <script>

    const getUser = (revers = false) => {
      const condition = revers ? !is_staff : is_staff
      return condition ? 'teacher' : 'student'
    }

    const is_staff = JSON.parse(document.getElementById('is_staff').textContent)
    const teacher = JSON.parse(document.getElementById('teacher').textContent)
    const student = JSON.parse(document.getElementById('student').textContent)
    const lesson = JSON.parse(document.getElementById('lesson').textContent)

    const username = getUser()

    $(document).ready(function() {

      $('#callButton').click(function() {
        createCall()
      })
      $('#fsButton').click(function() {
        fullScreenmode(true)
      })
      if (showLog) $('#log').removeClass('hidden')
    })
  </script>

{% endblock %}
